{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\jiang\\\\Documents\\\\GitHub\\\\DesignInAction-WebsiteTest-5\\\\src\\\\components\\\\DesignStudio.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useRef } from 'react';\nimport * as THREE from 'three';\nimport { OrbitControls } from 'three/examples/jsm/controls/OrbitControls';\nimport { TransformControls } from 'three/examples/jsm/controls/TransformControls';\nimport useStore from '../store';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst DesignStudio = () => {\n  _s();\n  const containerRef = useRef();\n  const {\n    buildingData,\n    selectedObject,\n    updateObject\n  } = useStore();\n  const sceneRef = useRef();\n  const cameraRef = useRef();\n  const rendererRef = useRef();\n  const controlsRef = useRef();\n  useEffect(() => {\n    if (!containerRef.current) return;\n\n    // 初始化Three.js场景\n    const scene = new THREE.Scene();\n    sceneRef.current = scene;\n\n    // 设置相机\n    const camera = new THREE.PerspectiveCamera(75, window.innerWidth * 0.7 / window.innerHeight, 0.1, 50000);\n    camera.position.set(15000, 15000, 15000);\n    cameraRef.current = camera;\n\n    // 设置渲染器\n    const renderer = new THREE.WebGLRenderer({\n      antialias: true\n    });\n    renderer.setSize(window.innerWidth * 0.7, window.innerHeight);\n    renderer.shadowMap.enabled = true;\n    containerRef.current.appendChild(renderer.domElement);\n    rendererRef.current = renderer;\n\n    // 添加光源\n    const ambientLight = new THREE.AmbientLight(0x404040, 2);\n    scene.add(ambientLight);\n    const directionalLight = new THREE.DirectionalLight(0xffffff, 2);\n    directionalLight.position.set(10000, 20000, 10000);\n    scene.add(directionalLight);\n\n    // 添加控制器\n    const controls = new OrbitControls(camera, renderer.domElement);\n    controls.enableDamping = true;\n    controlsRef.current = controls;\n\n    // 动画循环\n    const animate = () => {\n      requestAnimationFrame(animate);\n      controls.update();\n      renderer.render(scene, camera);\n    };\n    animate();\n\n    // 保存container引用用于清理\n    const container = containerRef.current;\n\n    // 清理函数\n    return () => {\n      if (container) {\n        container.removeChild(renderer.domElement);\n      }\n      renderer.dispose();\n    };\n  }, []);\n\n  // 加载建筑数据\n  useEffect(() => {\n    if (!buildingData || !sceneRef.current) return;\n\n    // 清除现有对象\n    sceneRef.current.children = sceneRef.current.children.filter(child => !(child instanceof THREE.Mesh));\n\n    // 加载新对象\n    buildingData.objects.forEach(obj => {\n      // 创建几何体\n      const geometry = new THREE.BufferGeometry();\n      // ... 根据obj.geometry创建几何体\n\n      // 创建材质\n      const material = new THREE.MeshPhongMaterial({\n        color: new THREE.Color(...obj.material.color),\n        transparent: obj.material.transparency > 0,\n        opacity: 1 - obj.material.transparency\n      });\n\n      // 创建网格\n      const mesh = new THREE.Mesh(geometry, material);\n      mesh.position.set(...obj.transform.position);\n      mesh.rotation.set(...obj.transform.rotation);\n      mesh.scale.set(...obj.transform.scale);\n      sceneRef.current.add(mesh);\n    });\n  }, [buildingData]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    ref: containerRef,\n    className: \"w-7/10 h-full bg-gray-100\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 105,\n    columnNumber: 5\n  }, this);\n};\n_s(DesignStudio, \"1oOEaHq1jyM/tjDghlzSBELlfq8=\", false, function () {\n  return [useStore];\n});\n_c = DesignStudio;\nexport default DesignStudio;\nvar _c;\n$RefreshReg$(_c, \"DesignStudio\");","map":{"version":3,"names":["React","useEffect","useRef","THREE","OrbitControls","TransformControls","useStore","jsxDEV","_jsxDEV","DesignStudio","_s","containerRef","buildingData","selectedObject","updateObject","sceneRef","cameraRef","rendererRef","controlsRef","current","scene","Scene","camera","PerspectiveCamera","window","innerWidth","innerHeight","position","set","renderer","WebGLRenderer","antialias","setSize","shadowMap","enabled","appendChild","domElement","ambientLight","AmbientLight","add","directionalLight","DirectionalLight","controls","enableDamping","animate","requestAnimationFrame","update","render","container","removeChild","dispose","children","filter","child","Mesh","objects","forEach","obj","geometry","BufferGeometry","material","MeshPhongMaterial","color","Color","transparent","transparency","opacity","mesh","transform","rotation","scale","ref","className","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/jiang/Documents/GitHub/DesignInAction-WebsiteTest-5/src/components/DesignStudio.js"],"sourcesContent":["import React, { useEffect, useRef } from 'react';\r\nimport * as THREE from 'three';\r\nimport { OrbitControls } from 'three/examples/jsm/controls/OrbitControls';\r\nimport { TransformControls } from 'three/examples/jsm/controls/TransformControls';\r\nimport useStore from '../store';\r\n\r\nconst DesignStudio = () => {\r\n  const containerRef = useRef();\r\n  const { buildingData, selectedObject, updateObject } = useStore();\r\n  const sceneRef = useRef();\r\n  const cameraRef = useRef();\r\n  const rendererRef = useRef();\r\n  const controlsRef = useRef();\r\n\r\n  useEffect(() => {\r\n    if (!containerRef.current) return;\r\n\r\n    // 初始化Three.js场景\r\n    const scene = new THREE.Scene();\r\n    sceneRef.current = scene;\r\n    \r\n    // 设置相机\r\n    const camera = new THREE.PerspectiveCamera(\r\n      75,\r\n      window.innerWidth * 0.7 / window.innerHeight,\r\n      0.1,\r\n      50000\r\n    );\r\n    camera.position.set(15000, 15000, 15000);\r\n    cameraRef.current = camera;\r\n\r\n    // 设置渲染器\r\n    const renderer = new THREE.WebGLRenderer({ antialias: true });\r\n    renderer.setSize(window.innerWidth * 0.7, window.innerHeight);\r\n    renderer.shadowMap.enabled = true;\r\n    containerRef.current.appendChild(renderer.domElement);\r\n    rendererRef.current = renderer;\r\n\r\n    // 添加光源\r\n    const ambientLight = new THREE.AmbientLight(0x404040, 2);\r\n    scene.add(ambientLight);\r\n    \r\n    const directionalLight = new THREE.DirectionalLight(0xffffff, 2);\r\n    directionalLight.position.set(10000, 20000, 10000);\r\n    scene.add(directionalLight);\r\n\r\n    // 添加控制器\r\n    const controls = new OrbitControls(camera, renderer.domElement);\r\n    controls.enableDamping = true;\r\n    controlsRef.current = controls;\r\n\r\n    // 动画循环\r\n    const animate = () => {\r\n      requestAnimationFrame(animate);\r\n      controls.update();\r\n      renderer.render(scene, camera);\r\n    };\r\n    animate();\r\n\r\n    // 保存container引用用于清理\r\n    const container = containerRef.current;\r\n\r\n    // 清理函数\r\n    return () => {\r\n      if (container) {\r\n        container.removeChild(renderer.domElement);\r\n      }\r\n      renderer.dispose();\r\n    };\r\n  }, []);\r\n\r\n  // 加载建筑数据\r\n  useEffect(() => {\r\n    if (!buildingData || !sceneRef.current) return;\r\n\r\n    // 清除现有对象\r\n    sceneRef.current.children = sceneRef.current.children.filter(\r\n      child => !(child instanceof THREE.Mesh)\r\n    );\r\n\r\n    // 加载新对象\r\n    buildingData.objects.forEach(obj => {\r\n      // 创建几何体\r\n      const geometry = new THREE.BufferGeometry();\r\n      // ... 根据obj.geometry创建几何体\r\n\r\n      // 创建材质\r\n      const material = new THREE.MeshPhongMaterial({\r\n        color: new THREE.Color(...obj.material.color),\r\n        transparent: obj.material.transparency > 0,\r\n        opacity: 1 - obj.material.transparency,\r\n      });\r\n\r\n      // 创建网格\r\n      const mesh = new THREE.Mesh(geometry, material);\r\n      mesh.position.set(...obj.transform.position);\r\n      mesh.rotation.set(...obj.transform.rotation);\r\n      mesh.scale.set(...obj.transform.scale);\r\n\r\n      sceneRef.current.add(mesh);\r\n    });\r\n  }, [buildingData]);\r\n\r\n  return (\r\n    <div \r\n      ref={containerRef} \r\n      className=\"w-7/10 h-full bg-gray-100\"\r\n    />\r\n  );\r\n};\r\n\r\nexport default DesignStudio; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}